
> mastra-accounting-automation@1.0.1 dev
> next dev

   ‚ñ≤ Next.js 14.1.0
   - Local:        http://localhost:3000
   - Environments: .env.local, .env

 ‚úì Ready in 1430ms
 ‚úì Compiled /middleware in 149ms (64 modules)
 ‚óã Compiling /documents ...

warn - Your `content` configuration includes a pattern which looks like it's accidentally matching all of `node_modules` and can cause serious performance issues.
warn - Pattern: `./src/**/*.ts`
warn - See our documentation for recommendations:
warn - https://tailwindcss.com/docs/content-configuration#pattern-recommendations
 ‚ö† ./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
Critical dependency: the request of a dependency is an expression

Import trace for requested module:
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@prisma/instrumentation/dist/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/prisma.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx

./node_modules/require-in-the-middle/index.js
Critical dependency: require function is used in a way in which dependencies cannot be statically extracted

Import trace for requested module:
./node_modules/require-in-the-middle/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/postgresjs.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx
üîµüîµüîµ DocumentsPage „Åå„É¨„É≥„ÉÄ„É™„É≥„Ç∞„Åï„Çå„Åæ„Åó„ÅüÔºÅ
üü°üü°üü° useAzureMongoDBServer: true
üü°üü°üü° useAzureMongoDBClient: true
üü°üü°üü° useAzureMongoDB (final): true
üü¢üü¢üü¢ ‰ΩøÁî®„Åô„Çã„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà: DocumentsContent (Âº∑Âà∂)
üî¥üî¥üî¥ DocumentsContent „Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„Åå„Éû„Ç¶„É≥„Éà„Åï„Çå„Åæ„Åó„ÅüÔºÅ
 ‚ö† ./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
Critical dependency: the request of a dependency is an expression

Import trace for requested module:
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@prisma/instrumentation/dist/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/prisma.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx

./node_modules/require-in-the-middle/index.js
Critical dependency: require function is used in a way in which dependencies cannot be statically extracted

Import trace for requested module:
./node_modules/require-in-the-middle/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/postgresjs.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx
 ‚ö† ./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
Critical dependency: the request of a dependency is an expression

Import trace for requested module:
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@prisma/instrumentation/dist/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/prisma.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx

./node_modules/require-in-the-middle/index.js
Critical dependency: require function is used in a way in which dependencies cannot be statically extracted

Import trace for requested module:
./node_modules/require-in-the-middle/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/postgresjs.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx
[2025-07-21T15:39:23.458Z] [DEBUG] Creating new MongoDB connection... 
[2025-07-21T15:39:23.458Z] [DEBUG] MongoDB URI configured: mongodb://localhost:27017/mastra-accounting
üîç [OCR-Results API] „É™„ÇØ„Ç®„Çπ„ÉàÂèó‰ø°
üìä [OCR-Results API] „Éï„Ç£„É´„Çø„Éº: {
  "companyId": "11111111-1111-1111-1111-111111111111",
  "ocrStatus": {
    "$exists": true
  },
  "$or": [
    {
      "linked_document_id": {
        "$exists": false
      }
    },
    {
      "linked_document_id": null
    }
  ],
  "status": {
    "$ne": "archived"
  },
  "hiddenFromList": {
    "$ne": true
  }
}
üìÑ [OCR-Results API] „Éö„Éº„Ç∏Ë®≠ÂÆö: { page: 1, limit: 20, skip: 0 }
üîÑ [OCR-Results API] „ÇΩ„Éº„ÉàË®≠ÂÆö: { sortBy: 'date', sortOrder: 'desc' }
üîÑ [OCR-Results API] „ÇΩ„Éº„Éà„Ç™„Éó„Ç∑„Éß„É≥: { receipt_date: -1, createdAt: -1 }
[2025-07-21T15:39:23.470Z] [DEBUG] Documents list API - MongoDB URI exists: true
üîµüîµüîµ DocumentsPage „Åå„É¨„É≥„ÉÄ„É™„É≥„Ç∞„Åï„Çå„Åæ„Åó„ÅüÔºÅ
üü°üü°üü° useAzureMongoDBServer: true
üü°üü°üü° useAzureMongoDBClient: true
üü°üü°üü° useAzureMongoDB (final): true
üü¢üü¢üü¢ ‰ΩøÁî®„Åô„Çã„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà: DocumentsContent (Âº∑Âà∂)
[2025-07-21T15:39:28.465Z] [ERROR] MongoDB connection error: {
  errorLabelSet: {},
  reason: {
    type: 'Unknown',
    servers: {},
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: '[REDACTED]'
  },
  code: undefined
}
[2025-07-21T15:39:28.466Z] [ERROR] Connection error details: {
  name: 'MongoServerSelectionError',
  message: 'connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'MongoServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at Topology.selectServer (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:326:38)\n' +
    '    at async Topology._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:200:28)\n' +
    '    at async Topology.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:152:13)\n' +
    '    at async topologyConnect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:246:17)\n' +
    '    at async MongoClient._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:259:13)\n' +
    '    at async MongoClient.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:184:13)'
}
[2025-07-21T15:39:28.466Z] [DEBUG] Cached connection is stale, creating new connection... 
[2025-07-21T15:39:28.466Z] [DEBUG] Creating new MongoDB connection... 
[2025-07-21T15:39:28.466Z] [DEBUG] MongoDB URI configured: mongodb://localhost:27017/mastra-accounting
[2025-07-21T15:39:28.468Z] [DEBUG] Cached connection is stale, creating new connection... 
[2025-07-21T15:39:28.469Z] [DEBUG] Creating new MongoDB connection... 
[2025-07-21T15:39:28.469Z] [DEBUG] MongoDB URI configured: mongodb://localhost:27017/mastra-accounting
[2025-07-21T15:39:28.470Z] [DEBUG] Cached connection is stale, creating new connection... 
[2025-07-21T15:39:28.470Z] [DEBUG] Creating new MongoDB connection... 
[2025-07-21T15:39:28.470Z] [DEBUG] MongoDB URI configured: mongodb://localhost:27017/mastra-accounting
DatabaseError: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at connectToDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:118:15)
    at async getClientPromise (webpack-internal:///(rsc)/./lib/mongodb-client.ts:156:24) {
  code: 'CONNECTION_ERROR'
}
DatabaseError: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at connectToDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:118:15)
    at async getClientPromise (webpack-internal:///(rsc)/./lib/mongodb-client.ts:156:24) {
  code: 'CONNECTION_ERROR'
}
 ‚®Ø unhandledRejection: DatabaseError: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at connectToDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:118:15)
    at async getClientPromise (webpack-internal:///(rsc)/./lib/mongodb-client.ts:156:24) {
  code: 'CONNECTION_ERROR'
}
 ‚®Ø unhandledRejection: DatabaseError: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at connectToDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:118:15)
    at async getClientPromise (webpack-internal:///(rsc)/./lib/mongodb-client.ts:156:24) {
  code: 'CONNECTION_ERROR'
}
[2025-07-21T15:39:33.470Z] [ERROR] MongoDB connection error: {
  errorLabelSet: {},
  reason: {
    type: 'Unknown',
    servers: {},
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: '[REDACTED]'
  },
  code: undefined
}
[2025-07-21T15:39:33.471Z] [ERROR] Connection error details: {
  name: 'MongoServerSelectionError',
  message: 'connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'MongoServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at Topology.selectServer (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:326:38)\n' +
    '    at async Topology._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:200:28)\n' +
    '    at async Topology.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:152:13)\n' +
    '    at async topologyConnect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:246:17)\n' +
    '    at async MongoClient._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:259:13)\n' +
    '    at async MongoClient.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:184:13)\n' +
    '    at async connectToDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:99:33)\n' +
    '    at async getDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:124:24)\n' +
    '    at async eval (webpack-internal:///(rsc)/./lib/mongodb-client.ts:517:22)'
}
[2025-07-21T15:39:33.471Z] [ERROR] getDatabase error: { code: 'CONNECTION_ERROR', name: 'DatabaseError' }
DatabaseError: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:128:15)
    at async eval (webpack-internal:///(rsc)/./lib/mongodb-client.ts:517:22) {
  code: 'DATABASE_ACCESS_ERROR'
}
DatabaseError: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:128:15)
    at async eval (webpack-internal:///(rsc)/./lib/mongodb-client.ts:517:22) {
  code: 'DATABASE_ACCESS_ERROR'
}
 ‚®Ø unhandledRejection: DatabaseError: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:128:15)
    at async eval (webpack-internal:///(rsc)/./lib/mongodb-client.ts:517:22) {
  code: 'DATABASE_ACCESS_ERROR'
}
 ‚®Ø unhandledRejection: DatabaseError: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:128:15)
    at async eval (webpack-internal:///(rsc)/./lib/mongodb-client.ts:517:22) {
  code: 'DATABASE_ACCESS_ERROR'
}
[2025-07-21T15:39:33.474Z] [ERROR] MongoDB connection error: {
  errorLabelSet: {},
  reason: {
    type: 'Unknown',
    servers: {},
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: '[REDACTED]'
  },
  code: undefined
}
[2025-07-21T15:39:33.474Z] [ERROR] Connection error details: {
  name: 'MongoServerSelectionError',
  message: 'connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'MongoServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at Topology.selectServer (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:326:38)\n' +
    '    at runNextTicks (node:internal/process/task_queues:65:5)\n' +
    '    at listOnTimeout (node:internal/timers:569:9)\n' +
    '    at process.processTimers (node:internal/timers:543:7)\n' +
    '    at async Topology._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:200:28)\n' +
    '    at async Topology.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:152:13)\n' +
    '    at async topologyConnect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:246:17)\n' +
    '    at async MongoClient._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:259:13)\n' +
    '    at async MongoClient.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:184:13)\n' +
    '    at async connectToDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:99:33)\n' +
    '    at async getDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:124:24)\n' +
    '    at async getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:134:20)\n' +
    '    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)\n' +
    '    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809\n' +
    '    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)\n' +
    '    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)\n' +
    '    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)\n' +
    '    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)\n' +
    '    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)\n' +
    '    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)\n' +
    '    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20\n' +
    '    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)\n' +
    '    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)\n' +
    '    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)\n' +
    '    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)\n' +
    '    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)\n' +
    '    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)'
}
[2025-07-21T15:39:33.475Z] [ERROR] getDatabase error: { code: 'CONNECTION_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:33.475Z] [ERROR] getCollection error for documents: { code: 'DATABASE_ACCESS_ERROR', name: 'DatabaseError' }
OCR results API error: DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)
    at runNextTicks (node:internal/process/task_queues:65:5)
    at listOnTimeout (node:internal/timers:569:9)
    at process.processTimers (node:internal/timers:543:7)
    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)
    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809
    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)
    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)
    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)
    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)
    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)
    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)
    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20
    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)
    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)
    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)
    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)
    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)
    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13) {
  code: 'COLLECTION_ACCESS_ERROR'
}
Error stack: DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)
    at runNextTicks (node:internal/process/task_queues:65:5)
    at listOnTimeout (node:internal/timers:569:9)
    at process.processTimers (node:internal/timers:543:7)
    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)
    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809
    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)
    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)
    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)
    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)
    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)
    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)
    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20
    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)
    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)
    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)
    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)
    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)
    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)
[2025-07-21T15:39:33.485Z] [ERROR] MongoDB connection error: {
  errorLabelSet: {},
  reason: {
    type: 'Unknown',
    servers: {},
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: '[REDACTED]'
  },
  code: undefined
}
[2025-07-21T15:39:33.485Z] [ERROR] Connection error details: {
  name: 'MongoServerSelectionError',
  message: 'connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'MongoServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at Topology.selectServer (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:326:38)\n' +
    '    at async Topology._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:200:28)\n' +
    '    at async Topology.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:152:13)\n' +
    '    at async topologyConnect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:246:17)\n' +
    '    at async MongoClient._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:259:13)\n' +
    '    at async MongoClient.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:184:13)\n' +
    '    at async connectToDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:99:33)\n' +
    '    at async getDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:124:24)\n' +
    '    at async getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:134:20)\n' +
    '    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)\n' +
    '    at async GET (webpack-internal:///(rsc)/./app/api/documents/list/route.ts:76:27)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809\n' +
    '    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)\n' +
    '    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)\n' +
    '    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)\n' +
    '    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)\n' +
    '    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)\n' +
    '    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)\n' +
    '    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20\n' +
    '    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)\n' +
    '    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)\n' +
    '    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)\n' +
    '    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)\n' +
    '    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)\n' +
    '    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)'
}
[2025-07-21T15:39:33.486Z] [ERROR] getDatabase error: { code: 'CONNECTION_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:33.486Z] [ERROR] getCollection error for documents: { code: 'DATABASE_ACCESS_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:33.486Z] [ERROR] Document list error: { code: 'COLLECTION_ACCESS_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:33.486Z] [ERROR] Error details: {
  name: 'DatabaseError',
  message: 'Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)\n' +
    '    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)\n' +
    '    at async GET (webpack-internal:///(rsc)/./app/api/documents/list/route.ts:76:27)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809\n' +
    '    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)\n' +
    '    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)\n' +
    '    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)\n' +
    '    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)\n' +
    '    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)\n' +
    '    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)\n' +
    '    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20\n' +
    '    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)\n' +
    '    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)\n' +
    '    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)\n' +
    '    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)\n' +
    '    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)\n' +
    '    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)'
}
[2025-07-21T15:39:33.514Z] [DEBUG] Documents list API - MongoDB URI exists: true
[2025-07-21T15:39:33.514Z] [DEBUG] Creating new MongoDB connection... 
[2025-07-21T15:39:33.514Z] [DEBUG] MongoDB URI configured: mongodb://localhost:27017/mastra-accounting
üîç [OCR-Results API] „É™„ÇØ„Ç®„Çπ„ÉàÂèó‰ø°
üìä [OCR-Results API] „Éï„Ç£„É´„Çø„Éº: {
  "companyId": "11111111-1111-1111-1111-111111111111",
  "ocrStatus": {
    "$exists": true
  },
  "$or": [
    {
      "linked_document_id": {
        "$exists": false
      }
    },
    {
      "linked_document_id": null
    }
  ],
  "status": {
    "$ne": "archived"
  },
  "hiddenFromList": {
    "$ne": true
  }
}
üìÑ [OCR-Results API] „Éö„Éº„Ç∏Ë®≠ÂÆö: { page: 1, limit: 20, skip: 0 }
üîÑ [OCR-Results API] „ÇΩ„Éº„ÉàË®≠ÂÆö: { sortBy: 'date', sortOrder: 'desc' }
üîÑ [OCR-Results API] „ÇΩ„Éº„Éà„Ç™„Éó„Ç∑„Éß„É≥: { receipt_date: -1, createdAt: -1 }
[2025-07-21T15:39:38.517Z] [ERROR] MongoDB connection error: {
  errorLabelSet: {},
  reason: {
    type: 'Unknown',
    servers: {},
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: '[REDACTED]'
  },
  code: undefined
}
[2025-07-21T15:39:38.517Z] [ERROR] Connection error details: {
  name: 'MongoServerSelectionError',
  message: 'connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'MongoServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at Topology.selectServer (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:326:38)\n' +
    '    at async Topology._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:200:28)\n' +
    '    at async Topology.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:152:13)\n' +
    '    at async topologyConnect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:246:17)\n' +
    '    at async MongoClient._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:259:13)\n' +
    '    at async MongoClient.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:184:13)'
}
[2025-07-21T15:39:38.517Z] [DEBUG] Cached connection is stale, creating new connection... 
[2025-07-21T15:39:38.518Z] [DEBUG] Creating new MongoDB connection... 
[2025-07-21T15:39:38.518Z] [DEBUG] MongoDB URI configured: mongodb://localhost:27017/mastra-accounting
[2025-07-21T15:39:38.520Z] [ERROR] getDatabase error: { code: 'CONNECTION_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:38.520Z] [ERROR] getCollection error for documents: { code: 'DATABASE_ACCESS_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:38.521Z] [ERROR] Document list error: { code: 'COLLECTION_ACCESS_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:38.521Z] [ERROR] Error details: {
  name: 'DatabaseError',
  message: 'Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)\n' +
    '    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)\n' +
    '    at async GET (webpack-internal:///(rsc)/./app/api/documents/list/route.ts:76:27)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809\n' +
    '    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)\n' +
    '    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)\n' +
    '    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)\n' +
    '    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)\n' +
    '    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)\n' +
    '    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)\n' +
    '    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20\n' +
    '    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)\n' +
    '    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)\n' +
    '    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)\n' +
    '    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)\n' +
    '    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)\n' +
    '    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)'
}
üîç [OCR-Results API] „É™„ÇØ„Ç®„Çπ„ÉàÂèó‰ø°
üìä [OCR-Results API] „Éï„Ç£„É´„Çø„Éº: {
  "companyId": "11111111-1111-1111-1111-111111111111",
  "ocrStatus": {
    "$exists": true
  },
  "$or": [
    {
      "linked_document_id": {
        "$exists": false
      }
    },
    {
      "linked_document_id": null
    }
  ],
  "status": {
    "$ne": "archived"
  },
  "hiddenFromList": {
    "$ne": true
  }
}
üìÑ [OCR-Results API] „Éö„Éº„Ç∏Ë®≠ÂÆö: { page: 1, limit: 20, skip: 0 }
üîÑ [OCR-Results API] „ÇΩ„Éº„ÉàË®≠ÂÆö: { sortBy: 'date', sortOrder: 'desc' }
üîÑ [OCR-Results API] „ÇΩ„Éº„Éà„Ç™„Éó„Ç∑„Éß„É≥: { receipt_date: -1, createdAt: -1 }
üîç [OCR-Results API] „É™„ÇØ„Ç®„Çπ„ÉàÂèó‰ø°
üìä [OCR-Results API] „Éï„Ç£„É´„Çø„Éº: {
  "companyId": "11111111-1111-1111-1111-111111111111",
  "ocrStatus": {
    "$exists": true
  },
  "$or": [
    {
      "linked_document_id": {
        "$exists": false
      }
    },
    {
      "linked_document_id": null
    }
  ],
  "status": {
    "$ne": "archived"
  },
  "hiddenFromList": {
    "$ne": true
  }
}
üìÑ [OCR-Results API] „Éö„Éº„Ç∏Ë®≠ÂÆö: { page: 1, limit: 20, skip: 0 }
üîÑ [OCR-Results API] „ÇΩ„Éº„ÉàË®≠ÂÆö: { sortBy: 'date', sortOrder: 'desc' }
üîÑ [OCR-Results API] „ÇΩ„Éº„Éà„Ç™„Éó„Ç∑„Éß„É≥: { receipt_date: -1, createdAt: -1 }
[2025-07-21T15:39:43.521Z] [ERROR] MongoDB connection error: {
  errorLabelSet: {},
  reason: {
    type: 'Unknown',
    servers: {},
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: '[REDACTED]'
  },
  code: undefined
}
[2025-07-21T15:39:43.521Z] [ERROR] Connection error details: {
  name: 'MongoServerSelectionError',
  message: 'connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'MongoServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at Topology.selectServer (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:326:38)\n' +
    '    at async Topology._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:200:28)\n' +
    '    at async Topology.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:152:13)\n' +
    '    at async topologyConnect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:246:17)\n' +
    '    at async MongoClient._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:259:13)\n' +
    '    at async MongoClient.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:184:13)'
}
[2025-07-21T15:39:43.521Z] [DEBUG] Cached connection is stale, creating new connection... 
[2025-07-21T15:39:43.521Z] [DEBUG] Creating new MongoDB connection... 
[2025-07-21T15:39:43.521Z] [DEBUG] MongoDB URI configured: mongodb://localhost:27017/mastra-accounting
[2025-07-21T15:39:43.523Z] [DEBUG] Cached connection is stale, creating new connection... 
[2025-07-21T15:39:43.523Z] [DEBUG] Creating new MongoDB connection... 
[2025-07-21T15:39:43.523Z] [DEBUG] MongoDB URI configured: mongodb://localhost:27017/mastra-accounting
[2025-07-21T15:39:43.524Z] [ERROR] getDatabase error: { code: 'CONNECTION_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:43.525Z] [ERROR] getCollection error for documents: { code: 'DATABASE_ACCESS_ERROR', name: 'DatabaseError' }
OCR results API error: DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)
    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)
    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809
    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)
    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)
    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)
    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)
    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)
    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)
    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20
    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)
    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)
    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)
    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)
    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)
    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13) {
  code: 'COLLECTION_ACCESS_ERROR'
}
Error stack: DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)
    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)
    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809
    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)
    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)
    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)
    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)
    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)
    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)
    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20
    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)
    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)
    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)
    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)
    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)
    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)
 ‚ö† ./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
Critical dependency: the request of a dependency is an expression

Import trace for requested module:
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@prisma/instrumentation/dist/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/prisma.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx

./node_modules/require-in-the-middle/index.js
Critical dependency: require function is used in a way in which dependencies cannot be statically extracted

Import trace for requested module:
./node_modules/require-in-the-middle/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/postgresjs.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx
 ‚ö† ./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
Critical dependency: the request of a dependency is an expression

Import trace for requested module:
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@prisma/instrumentation/dist/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/prisma.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx

./node_modules/require-in-the-middle/index.js
Critical dependency: require function is used in a way in which dependencies cannot be statically extracted

Import trace for requested module:
./node_modules/require-in-the-middle/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/instrumentation.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/platform/index.js
./node_modules/@sentry/node/node_modules/@opentelemetry/instrumentation/build/esm/index.js
./node_modules/@sentry/node/build/cjs/integrations/tracing/postgresjs.js
./node_modules/@sentry/node/build/cjs/index.js
./node_modules/@sentry/nextjs/build/cjs/index.server.js
./app/global-error.tsx
[2025-07-21T15:39:48.524Z] [ERROR] MongoDB connection error: {
  errorLabelSet: {},
  reason: {
    type: 'Unknown',
    servers: {},
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: '[REDACTED]'
  },
  code: undefined
}
[2025-07-21T15:39:48.525Z] [ERROR] Connection error details: {
  name: 'MongoServerSelectionError',
  message: 'connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'MongoServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at Topology.selectServer (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:326:38)\n' +
    '    at async Topology._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:200:28)\n' +
    '    at async Topology.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:152:13)\n' +
    '    at async topologyConnect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:246:17)\n' +
    '    at async MongoClient._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:259:13)\n' +
    '    at async MongoClient.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:184:13)\n' +
    '    at async connectToDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:99:33)\n' +
    '    at async getDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:124:24)\n' +
    '    at async getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:134:20)\n' +
    '    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)\n' +
    '    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809\n' +
    '    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)\n' +
    '    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)\n' +
    '    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)\n' +
    '    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)\n' +
    '    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)\n' +
    '    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)\n' +
    '    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20\n' +
    '    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)\n' +
    '    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)\n' +
    '    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)\n' +
    '    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)\n' +
    '    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)\n' +
    '    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)'
}
[2025-07-21T15:39:48.525Z] [ERROR] getDatabase error: { code: 'CONNECTION_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:48.525Z] [ERROR] getCollection error for documents: { code: 'DATABASE_ACCESS_ERROR', name: 'DatabaseError' }
OCR results API error: DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)
    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)
    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809
    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)
    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)
    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)
    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)
    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)
    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)
    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20
    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)
    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)
    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)
    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)
    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)
    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13) {
  code: 'COLLECTION_ACCESS_ERROR'
}
Error stack: DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)
    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)
    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809
    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)
    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)
    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)
    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)
    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)
    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)
    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20
    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)
    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)
    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)
    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)
    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)
    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)
[2025-07-21T15:39:48.531Z] [ERROR] MongoDB connection error: {
  errorLabelSet: {},
  reason: {
    type: 'Unknown',
    servers: {},
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: '[REDACTED]'
  },
  code: undefined
}
[2025-07-21T15:39:48.532Z] [ERROR] Connection error details: {
  name: 'MongoServerSelectionError',
  message: 'connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017',
  stack: 'MongoServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017\n' +
    '    at Topology.selectServer (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:326:38)\n' +
    '    at async Topology._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:200:28)\n' +
    '    at async Topology.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/sdam/topology.js:152:13)\n' +
    '    at async topologyConnect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:246:17)\n' +
    '    at async MongoClient._connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:259:13)\n' +
    '    at async MongoClient.connect (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/mongodb/lib/mongo_client.js:184:13)\n' +
    '    at async connectToDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:99:33)\n' +
    '    at async getDatabase (webpack-internal:///(rsc)/./lib/mongodb-client.ts:124:24)\n' +
    '    at async getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:134:20)\n' +
    '    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)\n' +
    '    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809\n' +
    '    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)\n' +
    '    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)\n' +
    '    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)\n' +
    '    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)\n' +
    '    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)\n' +
    '    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)\n' +
    '    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)\n' +
    '    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20\n' +
    '    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)\n' +
    '    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)\n' +
    '    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)\n' +
    '    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)\n' +
    '    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)\n' +
    '    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)'
}
[2025-07-21T15:39:48.532Z] [ERROR] getDatabase error: { code: 'CONNECTION_ERROR', name: 'DatabaseError' }
[2025-07-21T15:39:48.532Z] [ERROR] getCollection error for documents: { code: 'DATABASE_ACCESS_ERROR', name: 'DatabaseError' }
OCR results API error: DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)
    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)
    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809
    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)
    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)
    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)
    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)
    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)
    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)
    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20
    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)
    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)
    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)
    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)
    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)
    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13) {
  code: 'COLLECTION_ACCESS_ERROR'
}
Error stack: DatabaseError: Failed to get collection documents: Failed to get database instance: MongoDB connection failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at getCollection (webpack-internal:///(rsc)/./lib/mongodb-client.ts:151:15)
    at async DatabaseService.find (webpack-internal:///(rsc)/./lib/mongodb-client.ts:258:28)
    at async GET (webpack-internal:///(rsc)/./app/api/ocr-results/route.ts:187:28)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:63809
    at async eU.execute (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:53964)
    at async eU.handle (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:65062)
    at async doRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1333:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1555:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1463:28)
    at async DevServer.renderPageComponent (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1856:24)
    at async DevServer.renderToResponseImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:1894:32)
    at async DevServer.pipeImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:911:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/next-server.js:271:17)
    at async DevServer.handleRequestImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/base-server.js:807:17)
    at async /Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:331:20
    at async Span.traceAsyncFn (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/trace/trace.js:151:20)
    at async DevServer.handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/dev/next-dev-server.js:328:24)
    at async invokeRender (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:163:21)
    at async handleRequest (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:342:24)
    at async requestHandlerImpl (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/router-server.js:366:13)
    at async Server.requestListener (/Users/tonychustudio/Documents/aam-orchestration/accounting-automation/node_modules/next/dist/server/lib/start-server.js:140:13)
