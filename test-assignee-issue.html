<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å–¶æ¥­æ‹…å½“è€…è¡¨ç¤ºå•é¡Œ - è©³ç´°ãƒ‡ãƒãƒƒã‚°</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1f2937;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 10px;
        }
        .section {
            margin: 30px 0;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        .test-case {
            background: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }
        .test-title {
            font-weight: bold;
            color: #3b82f6;
            margin-bottom: 10px;
        }
        .code-block {
            background: #1f2937;
            color: #f3f4f6;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .highlight {
            background: #fbbf24;
            color: #1f2937;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }
        .status-ok {
            color: #10b981;
            font-weight: bold;
        }
        .status-error {
            color: #ef4444;
            font-weight: bold;
        }
        .status-warning {
            color: #f59e0b;
            font-weight: bold;
        }
        .debug-output {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 13px;
            white-space: pre-wrap;
            margin: 10px 0;
        }
        .solution-box {
            background: #ecfdf5;
            border: 2px solid #10b981;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .solution-title {
            font-size: 18px;
            font-weight: bold;
            color: #065f46;
            margin-bottom: 10px;
        }
        button {
            background: #3b82f6;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin: 5px;
        }
        button:hover {
            background: #2563eb;
        }
        .input-group {
            margin: 15px 0;
            padding: 15px;
            background: #f9fafb;
            border-radius: 6px;
        }
        .input-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #4b5563;
        }
        .input-group input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
        }
        .output-preview {
            border: 2px solid #e5e7eb;
            padding: 20px;
            border-radius: 8px;
            background: white;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” å–¶æ¥­æ‹…å½“è€…è¡¨ç¤ºå•é¡Œ - è©³ç´°ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«</h1>
        
        <div class="section">
            <h2>ğŸ“Œ å•é¡Œã®æ¦‚è¦</h2>
            <div class="test-case">
                <div class="test-title">ç¾åœ¨ã®ç—‡çŠ¶</div>
                <ul>
                    <li><span class="status-error">âœ—</span> é€ä¿¡è¨­å®šã‚¿ãƒ–ã§å–¶æ¥­æ‹…å½“è€…åã‚’å…¥åŠ›ã—ã¦ã‚‚ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«åæ˜ ã•ã‚Œãªã„</li>
                    <li><span class="status-warning">âš </span> staffNameã¨editedQuote.assigneeã®åŒæœŸãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ãªã„å¯èƒ½æ€§</li>
                    <li><span class="status-ok">âœ“</span> ã‚³ãƒ¼ãƒ‰ä¸Šã§ã¯ä¿®æ­£ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼ˆè¡Œ946-948ï¼‰</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ§ª ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ†ã‚¹ãƒˆ</h2>
            
            <div class="input-group">
                <label for="staff-name-input">å–¶æ¥­æ‹…å½“è€…åã‚’å…¥åŠ›:</label>
                <input type="text" id="staff-name-input" placeholder="ä¾‹: ç”°ä¸­å¤ªéƒ" />
            </div>
            
            <button onclick="testStateSync()">çŠ¶æ…‹åŒæœŸã‚’ãƒ†ã‚¹ãƒˆ</button>
            <button onclick="testPreviewGeneration()">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆã‚’ãƒ†ã‚¹ãƒˆ</button>
            <button onclick="clearTest()">ã‚¯ãƒªã‚¢</button>
            
            <div class="debug-output" id="debug-output">
ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...
            </div>
            
            <div class="output-preview" id="preview-output">
                <h3>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ</h3>
                <div id="preview-content">
                    ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ“ å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã®ç¢ºèª</h2>
            
            <div class="test-case">
                <div class="test-title">1. é€ä¿¡è¨­å®šã‚¿ãƒ–ã®åŒæœŸå‡¦ç†ï¼ˆè¡Œ946-948ï¼‰</div>
                <div class="code-block">
onChange={(e) => {
    setStaffName(e.target.value);
    <span class="highlight">setEditedQuote({...editedQuote, assignee: e.target.value});</span>
}}
                </div>
                <p>âœ… ã“ã®å®Ÿè£…ã¯æ­£ã—ã„ã§ã™ã€‚ä¸¡æ–¹ã®çŠ¶æ…‹ã‚’æ›´æ–°ã—ã¦ã„ã¾ã™ã€‚</p>
            </div>
            
            <div class="test-case">
                <div class="test-title">2. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆæ™‚ã®å„ªå…ˆé †ä½ï¼ˆè¡Œ125ï¼‰</div>
                <div class="code-block">
assignee: <span class="highlight">staffName</span> || editedQuote.assignee || companyInfo?.representativeName
                </div>
                <p>âœ… staffNameã‚’æœ€å„ªå…ˆã§ä½¿ç”¨ã™ã‚‹è¨­å®šã‚‚æ­£ã—ã„ã§ã™ã€‚</p>
            </div>
            
            <div class="test-case">
                <div class="test-title">3. QuoteWebTemplateã§ã®è¡¨ç¤ºï¼ˆè¡Œ329ï¼‰</div>
                <div class="code-block">
{quote.assignee && &lt;div&gt;æ‹…å½“è€…: {quote.assignee}&lt;/div&gt;}
                </div>
                <p>âœ… ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚‚æ­£ã—ãå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
            </div>
        </div>

        <div class="solution-box">
            <div class="solution-title">ğŸš€ è€ƒãˆã‚‰ã‚Œã‚‹åŸå› ã¨è§£æ±ºç­–</div>
            
            <h3>1. ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å•é¡Œ</h3>
            <p>é–‹ç™ºä¸­ã®Hot Module ReplacementãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>
            <div class="code-block">
# è§£æ±ºæ–¹æ³•:
1. ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ãï¼ˆF12ï¼‰
2. Networkã‚¿ãƒ–ã§ã€ŒDisable cacheã€ã«ãƒã‚§ãƒƒã‚¯
3. Cmd+Shift+Rï¼ˆMacï¼‰ã§ãƒãƒ¼ãƒ‰ãƒªãƒ­ãƒ¼ãƒ‰
            </div>
            
            <h3>2. React Stateã®æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚°</h3>
            <p>Reactã®çŠ¶æ…‹æ›´æ–°ãŒéåŒæœŸã§è¡Œã‚ã‚Œã‚‹ãŸã‚ã€å³åº§ã«åæ˜ ã•ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>
            <div class="code-block">
# ä¿®æ­£æ¡ˆ:
useEffect(() => {
    // staffNameãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰editedQuoteã‚‚æ›´æ–°
    setEditedQuote(prev => ({...prev, assignee: staffName}));
}, [staffName]);
            </div>
            
            <h3>3. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼APIå´ã®å•é¡Œ</h3>
            <p>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆã®APIã§æ‹…å½“è€…æƒ…å ±ãŒæ­£ã—ãæ¸¡ã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>
            <div class="code-block">
# ãƒ‡ãƒãƒƒã‚°æ–¹æ³•:
console.log('Preview API Request:', {
    assignee: quote.assignee,
    staffName: staffName,
    finalAssignee: previewQuote.assignee
});
            </div>
        </div>

        <div class="section">
            <h2>âœ… ç¢ºèªæ‰‹é †</h2>
            <ol>
                <li>é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•: <code>npm run dev</code></li>
                <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢</li>
                <li>ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ–ãƒ©ã‚¦ã‚¸ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ã§ç¢ºèª</li>
                <li>ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ç¢ºèª</li>
                <li>Networkã‚¿ãƒ–ã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ç¢ºèª</li>
            </ol>
        </div>
    </div>

    <script>
        function testStateSync() {
            const input = document.getElementById('staff-name-input').value;
            const output = document.getElementById('debug-output');
            
            if (!input) {
                output.textContent = 'âŒ å–¶æ¥­æ‹…å½“è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
                return;
            }
            
            // çŠ¶æ…‹åŒæœŸã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            const simulatedState = {
                staffName: input,
                editedQuote: {
                    assignee: input, // åŒæœŸã•ã‚Œã‚‹å€¤
                }
            };
            
            output.textContent = `
=== çŠ¶æ…‹åŒæœŸãƒ†ã‚¹ãƒˆ ===
å…¥åŠ›å€¤: "${input}"

1. setStaffName("${input}") å®Ÿè¡Œ
   âœ… staffName = "${input}"

2. setEditedQuote({...editedQuote, assignee: "${input}"}) å®Ÿè¡Œ
   âœ… editedQuote.assignee = "${input}"

3. åŒæœŸçµæœ:
   staffName: "${simulatedState.staffName}"
   editedQuote.assignee: "${simulatedState.editedQuote.assignee}"
   
âœ… åŒæœŸæˆåŠŸï¼ä¸¡æ–¹ã®å€¤ãŒä¸€è‡´ã—ã¦ã„ã¾ã™ã€‚
`;
        }
        
        function testPreviewGeneration() {
            const input = document.getElementById('staff-name-input').value;
            const output = document.getElementById('debug-output');
            const preview = document.getElementById('preview-content');
            
            if (!input) {
                output.textContent = 'âŒ å–¶æ¥­æ‹…å½“è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
                return;
            }
            
            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            const previewQuote = {
                assignee: input || 'ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ‹…å½“è€…',
            };
            
            output.textContent = `
=== ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆãƒ†ã‚¹ãƒˆ ===
staffName: "${input}"
editedQuote.assignee: "${input}"
companyInfo?.representativeName: "ä»£è¡¨è€…å"

å„ªå…ˆé †ä½è¨ˆç®—:
assignee = staffName || editedQuote.assignee || companyInfo?.representativeName
assignee = "${input}" || "${input}" || "ä»£è¡¨è€…å"
çµæœ: "${previewQuote.assignee}"

âœ… ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®assigneeãŒæ­£ã—ãè¨­å®šã•ã‚Œã¾ã—ãŸã€‚
`;
            
            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼HTMLã®ç”Ÿæˆ
            preview.innerHTML = `
                <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                    <h4 style="color: #1f2937; margin-bottom: 15px;">è¦‹ç©å…ƒ</h4>
                    <div style="font-size: 14px; line-height: 1.6;">
                        <div><strong>ä¼šç¤¾å:</strong> æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«</div>
                        <div><strong>ä½æ‰€:</strong> æ±äº¬éƒ½æ¸‹è°·åŒº...</div>
                        <div><strong>TEL:</strong> 03-1234-5678</div>
                        <div><strong>Email:</strong> info@example.com</div>
                        <div style="color: #3b82f6; font-weight: bold;">
                            <strong>æ‹…å½“è€…:</strong> ${previewQuote.assignee}
                        </div>
                    </div>
                </div>
            `;
        }
        
        function clearTest() {
            document.getElementById('staff-name-input').value = '';
            document.getElementById('debug-output').textContent = 'ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...';
            document.getElementById('preview-content').innerHTML = 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...';
        }
    </script>
</body>
</html>